(window.webpackJsonpvimboy=window.webpackJsonpvimboy||[]).push([[0],{1442:function(e,t,n){"use strict";n.r(t);n(542);var i,o,a=40,r=800,s=640,c=a,u=s-3*a,d=u,l=u/a,h=n(3),y=n(4),w=n(37),f=n(36),m=n(106),p=n(38),v=n(66),g=n.n(v),b=n(539),O=n.n(b);!function(e){e.GREEN="#62b37d",e.BLUE="#23549b",e.BEIGE="#b39862",e.PINK="#ff5eaf",e.RED="#f74a5e",e.YELLOW="#ffea5e",e.GREY="#3e3e3e",e.WHITE="#ffffff"}(i||(i={})),function(e){e[e.BLACK=0]="BLACK",e[e.LIGHT_GREEN=5170510]="LIGHT_GREEN",e[e.GREEN=6468477]="GREEN",e[e.BLUE=2315419]="BLUE",e[e.LIGHT_BLUE=55039]="LIGHT_BLUE",e[e.WHITE=16777215]="WHITE",e[e.BEIGE=11769954]="BEIGE",e[e.DARK_GREEN=470023]="DARK_GREEN",e[e.DARKER_GREEN=402950]="DARKER_GREEN",e[e.RED=16206430]="RED",e[e.YELLOW=16771678]="YELLOW",e[e.PINK=16735919]="PINK",e[e.GREY=4079166]="GREY"}(o||(o={}));var E,k=a,T='"VT323"',L={fontFamily:T,fontSize:k},j=n(86),M=function(e){return e.x+e.width+3},x=a+18,N=["To play: vim","To play tutorial: tutorial","","help <term>   search for help on <term>","where <term> is one of: controls, gameplay"],C=["movement:","    k","h        l","    j"],P=["how to play:","TODO"],R=function(e,t,n){e.clearHistory(),e.addHistory(t),n.forEach((function(t){return e.addHistory(t)}))},B=["play","vim","vi","vimboy"],I=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],S=[].concat(Object(j.a)(I),[" "]),A=function(e){return function(t){switch(t.key){case"Enter":G(e);break;case"Backspace":U(e);break;case"ArrowUp":D(e,1,0);break;case"ArrowDown":D(e,-1,e.history.length-1);break;default:if(!S.includes(t.key.toLowerCase()))return;e.currentLine+=t.key,e.currentLine=e.currentLine.slice(0,r/(k/2)),e.lineText.setText(e.currentLine)}e.lineText.setText(e.currentLine),e.cursor.setX(M(e.lineText))}},D=function(e,t,n){var i=Object(j.a)(e.history).reverse(),o=i[e.historyPosition];void 0===o?0!==e.historyPosition&&(e.historyPosition=n,e.currentLine=i[n]||""):(e.currentLine=o,e.historyPosition+t===-1?e.historyPosition=i.length-1:e.historyPosition+=t)},U=function(e){e.currentLine.length>0&&(e.currentLine=e.currentLine.slice(0,e.currentLine.length-1))},G=function(e){e.history.length>=s/a-4&&e.clearHistory(),function(e,t){if(B.includes(t))return e.scene.start("Game");switch(e.addHistory(t),t){case"help":R(e,t,N);break;case"tutorial":return window.tutorialMode=!0,e.scene.start("Game");case"help controls":R(e,t,C);break;case"help gameplay":R(e,t,P);break;case"":break;default:e.addHistory("command not found: ".concat(t))}e.moveDownALine()}(e,e.currentLine.toLowerCase())},K={active:!1,visible:!1,key:"Menu"},V=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(w.a)(this,Object(f.a)(t).call(this,K))).history=[],e.historyPosition=0,e.currentLine="",e.lineText=void 0,e.header=void 0,e.preamble=void 0,e.cursor=void 0,e.historyObj=void 0,e.onLoaded=function(){e.historyObj=e.add.group(),e.header=e.add.text(a,0,"vimboy@octobass.games",{fontFamily:T,fontSize:k,color:i.PINK}),e.preamble=e.add.text(a,k,"~",{fontFamily:T,fontSize:k,color:i.YELLOW}),e.lineText=e.add.text(a+30,k,"",{fontFamily:T,fontSize:k}),e.cursor=e.add.rectangle(M(e.lineText),k+a/2,5,a,o.WHITE),e.tweens.add({targets:e.cursor,alpha:{from:0,to:1},ease:"Cubic",duration:1e3,repeat:-1,yoyo:!1}),e.input.keyboard.on("keydown",A(Object(m.a)(e)))},e.moveDownALine=function(){var t=e.historyObj.getChildren().length;e.currentLine="",e.lineText.setY((t+1)*k),e.cursor.setY((t+1)*k+a/2),e.preamble.setY((t+1)*k),e.header.setY(t*k),e.historyPosition=0},window.tutorialMode=!1,e}return Object(p.a)(t,e),Object(y.a)(t,[{key:"preload",value:function(){var e=this,t=this.add.text(r/2,s/2,"loading"),n=this.add.rectangle(r/2,s/2,r,s);n.setFillStyle(o.BLACK),n.setDepth(2),t.setDepth(3),O.a.load({google:{families:["VT323"]},active:function(){t.destroy(),n.destroy(),e.onLoaded()}})}},{key:"create",value:function(){this.currentLine=""}},{key:"update",value:function(){}},{key:"clearHistory",value:function(){this.history=[],this.historyObj.clear(!0)}},{key:"addHistory",value:function(e){var t=this.historyObj.getChildren().length+1;this.history.push(e),this.historyObj.add(this.add.text(x,(t-1)*k,e,{fontFamily:T,fontSize:k}))}}]),t}(g.a.Scene),Y=function(){function e(t){Object(h.a)(this,e),this.graphics=void 0,this.graphics=t}return Object(y.a)(e,[{key:"drawBackground",value:function(){var e=window.scene.add.rectangle(c/2,u/2,c,u);e.setFillStyle(o.BLACK),e.setDepth(2);for(var t=0;t<u/a;t++){var n=t*a,s=new g.a.Geom.Rectangle(c,n,r,a);this.graphics.fillStyle(t%2===0?o.DARKER_GREEN:o.DARK_GREEN),this.graphics.fillRectShape(s);var d=window.scene.add.text(0,n,(t+1).toString(),{fontFamily:T,fontSize:k,align:"right",fixedWidth:c-5,color:i.WHITE});d.setAlpha(.5),d.setDepth(3)}}}]),e}(),_=function(){function e(){Object(h.a)(this,e),this.update=function(e){},this.currentLine=function(e){return(e.y+a/2)/a},this.bottomLine=function(){return u/a},this.clamp=function(e,t,n){return e<=t?t:e>=n?n:e}}return Object(y.a)(e,[{key:"downALine",value:function(e){e.y+a>=d||(window.scene.vimboy.playDown(),e.setY(e.y+a))}},{key:"upALine",value:function(e){e.y-a<=0||(window.scene.vimboy.playUp(),e.setY(e.y-a))}},{key:"jumpToLine",value:function(e,t){var n=this.clamp(e,1,this.bottomLine());window.scene.vimboy.playPop(),t.setY(n*a-a/2)}},{key:"jumpBackNLines",value:function(e,t){var n=this.currentLine(t)-e;this.jumpToLine(n,t)}}]),e}();!function(e){e.VIMBOY="vimboy",e.POWER_UP_CONTAINER="POWER_UP_CONTAINER",e.GHOST="GHOST",e.TROPHY="TROPHY"}(E||(E={}));var W,H=15,F=14,X=function(){window.scene.load.spritesheet(E.VIMBOY,"https://i.imgur.com/ND67D6J.png",{frameWidth:50,frameHeight:a}),window.scene.load.image(E.POWER_UP_CONTAINER,"https://i.imgur.com/terj3t4.png"),window.scene.load.image(E.GHOST,"https://i.imgur.com/4gnVJiV.png"),window.scene.load.image(E.TROPHY,"https://i.imgur.com/O5dS6aL.png")};!function(e){e.VIMBOY_BOB="VIMBOY_BOB",e.VIMBOY_WORD_ATTACK="VIMBOY_WORD_ATTACK",e.VIMBOY_UP="VIMBOY_UP",e.VIMBOY_DOWN="VIMBOY_DOWN",e.VIMBOY_POP="VIMBOY_POP",e.CLASH="CLASH"}(W||(W={}));var z,q=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{key:e,frames:window.scene.anims.generateFrameNumbers(E.VIMBOY,{frames:Array.from(Array(n).keys()).map((function(e){return t+e}))}),frameRate:10,repeat:i}},J=function(e){window.scene.physics.world.enableBody(e);var t=e.body;return t.setAllowGravity(!1),t},Q=function(e,t){e.setAllowRotation(!1),e.setVelocityX(window.scene.tweens.timeScale*t)};!function(e){e.WORD_TYPE_ENEMY="WORD_TYPE_ENEMY",e.WORD_ATTACK="WORD_ATTACK",e.PICKUP="PICKUP"}(z||(z={}));var Z=[["console",".","log","(","'Hello, World!'",")"],["const"," ","fn"," ","=","(",")","=>","{}"],["class"," ","Pizza"," ","{}"],["Random",".","getNumber","(","words",".","length",")"],["range","(","2",",","10",")"]],$=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,null,[{key:"getNumber",value:function(e){return Math.round(Math.floor(Math.random()*Math.floor(e)))}},{key:"getRandomInt",value:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}},{key:"getWords",value:function(){var t=e.getNumber(Z.length);return Z[t]}},{key:"randomEnum",value:function(e){var t=Object.keys(e).map((function(e){return Number.parseInt(e)})).filter((function(e){return!Number.isNaN(e)}));return t[Math.floor(Math.random()*t.length)]}},{key:"randomStringEnum",value:function(t){var n=Object.values(t);return n[e.getNumber(n.length)]}},{key:"getColour",value:function(){var t=e.getNumber(this.colours.length);return this.colours[t]}},{key:"getStringColour",value:function(){var t=e.getNumber(this.stringColours.length);return this.stringColours[t]}}]),e}();$.colours=[o.PINK,o.RED,o.YELLOW,o.BLUE,o.GREEN],$.stringColours=[i.PINK,i.RED,i.YELLOW,i.BLUE,i.GREEN],$.randomBool=function(){return 1===$.getNumber(2)};var ee,te=$,ne=function(e,t){var n=window.scene.add.sprite(e,t,E.VIMBOY).setTint(te.getColour()).setAlpha(.7);n.setFrame(10),n.anims.play(W.CLASH),window.scene.time.addEvent({delay:200,callback:function(){n.destroy()}})};!function(e){e.MUSIC="music",e.BAD="bad",e.GOOD="good",e.DEATH="death",e.GOOD_SCORE="good-score",e.BOOP="boop"}(ee||(ee={}));var ie,oe=function(e){return"https://storage.googleapis.com/octobass-vimboy/sounds/".concat(e,".wav")},ae=function(){window.scene.load.audio(ee.MUSIC,[oe("vimboy-theme")]),window.scene.load.audio(ee.BAD,[oe("bad")]),window.scene.load.audio(ee.DEATH,[oe("death")]),window.scene.load.audio(ee.GOOD,[oe("good")]),window.scene.load.audio(ee.BOOP,[oe("boop")]),window.scene.load.audio(ee.GOOD_SCORE,[oe("good-score")])},re=function e(){var t=this;Object(h.a)(this,e),this.movement=void 0,this.vimboy=void 0,this.bulletProof=!1,this.create=function(){t.bulletProof=!1,t.movement=new _,t.vimboy=window.scene.add.sprite(c+25,u-a/2,E.VIMBOY),J(t.vimboy),window.scene.vimboy.changeColour(o.LIGHT_GREEN)},this.update=function(){t.movement.update(t.vimboy),t.vimboy.anims.isPlaying||t.vimboy.anims.play(W.VIMBOY_BOB,!0)},this.onEnemyCollision=function(e,n){t.bulletProof||(window.scene.entityManager.destroyEnemy(n),window.scene.health.injure(),t.vimboy.setTint(o.RED),window.scene.time.addEvent({delay:200,callback:function(){t.vimboy.setTint(window.scene.modeManager.getCurrentColour())}}))},this.setBulletProof=function(e){t.bulletProof=e},this.onPickupCollision=function(e,t){var n=t.getData("data");if(n.type===z.PICKUP){var i=t;ne(i.x,i.y),window.scene.sound.play(ee.BOOP),window.scene.entityManager.destroyNonEnemy(t),window.scene.powerUpManager.addPowerUp(n.colour)}},this.playWordAttack=function(){return t.vimboy.anims.play(W.VIMBOY_WORD_ATTACK,!0)},this.playUp=function(){return t.vimboy.anims.play(W.VIMBOY_UP,!0)},this.playDown=function(){return t.vimboy.anims.play(W.VIMBOY_DOWN,!0)},this.playPop=function(){return t.vimboy.anims.play(W.VIMBOY_POP,!0)},this.jumpToLine=function(e){return t.movement.jumpToLine(e,t.vimboy)},this.getLineNumber=function(){return t.movement.currentLine(t.vimboy)},this.jumpBackNLines=function(e){return t.movement.jumpBackNLines(e,t.vimboy)},this.currentLine=function(){return t.movement.currentLine(t.vimboy)},this.changeColour=function(e){return t.vimboy.setTint(e)}},se=function e(t,n){Object(h.a)(this,e),this.name=void 0,this.display=void 0,this.name=t,this.display=n};!function(e){e[e.NORMAL=0]="NORMAL",e[e.PICKUP=1]="PICKUP"}(ie||(ie={}));var ce,ue,de,le=n(75);!function(e){e.d="d"}(ue||(ue={})),function(e){e.w="w",e.d="d"}(de||(de={}));Object(le.a)({},ue.d,"Delete"),ce={},Object(le.a)(ce,de.w,"Word"),Object(le.a)(ce,de.d,"Line");var he=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.modeManager.switchToInsert()}}]),e}(),ye=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.vimboy.movement.downALine(window.scene.vimboy.vimboy)}}]),e}(),we=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.vimboy.movement.upALine(window.scene.vimboy.vimboy)}}]),e}(),fe=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.entityManager.moveEverythingRight()}}]),e}(),me=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.entityManager.moveEverythingLeft()}}]),e}(),pe=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.vimboy.movement.jumpToLine(1,window.scene.vimboy.vimboy)}}]),e}(),ve=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.vimboy.movement.jumpToLine(u/a,window.scene.vimboy.vimboy)}}]),e}(),ge=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.modeManager.switchToCommand()}}]),e}(),be=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){for(var e=window.scene,t=e.entityManager,n=e.vimboy,i=t.getEnemies().filter((function(e){return e.getData("data").line<n.currentLine()})).filter((function(e){var t=e.body;return t.x<25&&t.x+t.width>25})).map((function(e){return e.getData("data").line})).sort().reverse(),o=0;o<i.length&&i[o]-i[o+1]===1;)o++;i[o]&&n.jumpToLine(i[o])}}]),e}(),Oe=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){var e=window.scene.vimboy.currentLine(),t=window.scene.entityManager.getFirstWordOnLine(e-1);t&&(window.scene.scoreBoard.updateScore(t.text.length),window.scene.entityManager.destroyEnemy(t))}}]),e}(),Ee=n(540);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var Te=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){var e=window.scene.vimboy.currentLine(),t=window.scene.entityManager.getFirstWordOnLine(e-1);if(t){var n=t.getData("data");if(window.scene.scoreBoard.updateScore(n.words[0].length),1===n.words.length)window.scene.entityManager.destroyEnemy(t);else{var i=Object(Ee.a)(n.words).slice(1),o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach((function(t){Object(le.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n,{words:i});t.setData("data",o),t.setText(i.join(""))}}}}]),e}(),Le=[{key:"i",action:new he,type:ie.NORMAL},{key:"j",action:new ye,type:ie.NORMAL},{key:"k",action:new we,type:ie.NORMAL},{key:"h",action:new fe,type:ie.NORMAL},{key:"l",action:new me,type:ie.NORMAL},{key:"gg",action:new pe,type:ie.NORMAL},{key:"ShiftG",action:new ve,type:ie.NORMAL},{key:"Shift:",action:new ge,type:ie.NORMAL},{key:"Shift{",action:new be,type:ie.NORMAL},{key:"dd",action:new Oe,type:ie.PICKUP,verb:ue.d,noun:de.d,name:"Delete Line"},{key:"dw",action:new Te,type:ie.PICKUP,verb:ue.d,noun:de.w,name:"Delete Word"}],je=Object.values(ue),Me=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(w.a)(this,Object(f.a)(t).call(this,"normal",""))).input="",e.clear=function(){e.powerUpManager().clear(),e.input=""},e.useBinding=function(t){t.type===ie.PICKUP?e.handlePickup(t):(t.action.act(),e.clear())},e.handlePickup=function(t){if(e.powerUpManager().hasVerb()&&(e.powerUpManager().setNounIfAvailable(t.noun),e.powerUpManager().canUsePowerUp(t.verb,t.noun)))return e.powerUpManager().use(t.name),window.scene.sound.play(ee.GOOD),t.action.act(),void e.clear();e.powerUpManager().unusedClear(),e.input=""},e.powerUpManager=function(){return window.scene.powerUpManager},e}return Object(p.a)(t,e),Object(y.a)(t,[{key:"handle",value:function(e){var t=this,n=e.key.toLowerCase();if("escape"===n)this.clear();else{this.input=this.input.concat(n);var i=Le.find((function(e){return t.input===e.key.toLowerCase()}));if(i)this.useBinding(i);else if(Le.some((function(e){return e.key.toLowerCase().includes(t.input)}))){if(je.includes(this.input)){var o=this.input;this.powerUpManager().setVerbIfAvailable(o)}}else this.clear()}}}]),t}(se),xe=function(){function e(){Object(h.a)(this,e)}return Object(y.a)(e,[{key:"act",value:function(){window.scene.modeManager.switchToNormal()}}]),e}(),Ne=function(e){var t=e.x,n=e.y,i=e.word,o=e.xVelocity,a=e.colour,r=window.scene.add.text(t,n,i,{fontFamily:T,fontSize:k}).setColor(a),s=J(r);return Q(s,o),r},Ce=function(e){var t=window.scene.vimboy.vimboy.y-a/2,n=t/a,i=a,o=Ne({x:c+1.5*a,y:t,word:e,xVelocity:i,colour:te.getStringColour()}),r={line:n,type:z.WORD_ATTACK,normalVelocity:i};return o.setData({data:r}),o},Pe=function(e){function t(){return Object(h.a)(this,t),Object(w.a)(this,Object(f.a)(t).call(this,"insert","-- INSERT --"))}return Object(p.a)(t,e),Object(y.a)(t,[{key:"handle",value:function(e){"Escape"===e.key?(new xe).act():(window.scene.entityManager.createNonEnemy((function(){return Ce(e.key)})),window.scene.vimboy.playWordAttack())}}]),t}(se),Re=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(w.a)(this,Object(f.a)(t).call(this,"command",""))).input="",e.handleStringCommands=function(e){switch(e.toLowerCase()){case"q":return window.scene.sound.stopAll(),void window.scene.scene.start("Menu");default:console.log("command not found")}(new xe).act()},e}return Object(p.a)(t,e),Object(y.a)(t,[{key:"handle",value:function(e){var n=e.key.toLowerCase();if("enter"===n){var i=parseInt(this.input);isNaN(i)?this.handleStringCommands(this.input):(window.scene.vimboy.jumpToLine(i),(new xe).act())}else"backspace"===n&&this.input.length>0?this.input=this.input.slice(0,this.input.length-1):"escape"===n?(new xe).act():t.whitelist.includes(n)&&(this.input=this.input.concat(n))}},{key:"getCommand",value:function(){return this.input}}]),t}(se);Re.whitelist=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];var Be=Re,Ie=function(){function e(){var t=this;Object(h.a)(this,e),this.mode=void 0,this.colour=o.LIGHT_GREEN,this.allowedKeys=new Set,this.allowedKeysMode=!1,this.listen=function(){window.scene.keyCapturer.addListener("keydown",(function(e){t.allowedKeysMode?t.allowedKeys.has(e.key.toLowerCase())&&t.mode.handle(e):t.mode.handle(e)})),window.scene.tweens.setGlobalTimeScale(.2)},this.allow=function(){t.allowedKeysMode=!0;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){t.allowedKeys.add(e.toLowerCase())}))},this.allowNone=function(){t.allowedKeysMode=!0,t.allowedKeys=new Set},this.allowAll=function(){t.allowedKeysMode=!1,t.allowedKeys=new Set},this.setMode=function(e){t.mode=e},this.getCurrentColour=function(){return t.colour},this.mode=new Me}return Object(y.a)(e,[{key:"create",value:function(){this.allowedKeysMode=!1,this.allowedKeys=new Set,this.listen()}},{key:"update",value:function(){}},{key:"switchToInsert",value:function(){this.mode=new Pe,this.colour=o.LIGHT_BLUE,window.scene.vimboy.changeColour(this.colour),window.scene.tweens.setGlobalTimeScale(1),window.scene.entityManager.matchToTimescale()}},{key:"switchToNormal",value:function(){this.mode=new Me,this.colour=o.LIGHT_GREEN,window.scene.vimboy.changeColour(this.colour),window.scene.tweens.setGlobalTimeScale(.2),window.scene.entityManager.matchToTimescale()}},{key:"switchToCommand",value:function(){this.colour=o.PINK,window.scene.vimboy.changeColour(this.colour),window.scene.entityManager.matchToTimescale(),this.mode=new Be}}]),e}(),Se=function e(){var t=this;Object(h.a)(this,e),this.modeText=void 0,this.commandText=void 0,this.create=function(){t.initBackground(),t.initMode(),t.initCommandText()},this.update=function(){t.modeText.text!==t.modeString()&&t.modeText.setText(t.modeString()),"command"===t.mode().name?t.renderCommand():t.hideCommand()},this.hideCommand=function(){t.commandText.setText("")},this.renderCommand=function(){var e=window.scene.modeManager.mode;t.commandText.setText(":"+e.getCommand())},this.modeString=function(){return window.scene.modeManager.mode.display},this.mode=function(){return window.scene.modeManager.mode},this.initBackground=function(){var e=new Phaser.Geom.Rectangle(0,s-2*a,r,2*a);window.scene.graphics.fillStyle(o.BLACK),window.scene.graphics.fillRectShape(e)},this.initMode=function(){t.modeText=window.scene.add.text(10,s-a/2-10,t.modeString(),{fontFamily:T,fontSize:k/2})},this.initCommandText=function(){t.commandText=window.scene.add.text(0,d,"",{fontFamily:T,fontSize:k})}},Ae=function(){function e(){var t=this;Object(h.a)(this,e),this.text=void 0,this.score=0,this.updateScore=function(e){t.score+=e,t.text.setText(t.score.toString()).setX(t.getTextXPosition())},this.resetScore=function(){t.score=0,t.text.setText(t.score.toString()).setX(t.getTextXPosition())},this.getTextXPosition=function(){return r-30*t.score.toString().length}}return Object(y.a)(e,[{key:"create",value:function(){this.text=window.scene.add.text(this.getTextXPosition(),d,this.score.toString(),{fontFamily:T,fontSize:k})}}]),e}(),De=[o.RED,o.YELLOW,o.BLUE,o.GREEN,o.PINK],Ue=function(){function e(){var t=this;Object(h.a)(this,e),this.lifes=5,this.images=[],this.injure=function(){window.scene.sound.play(ee.BAD),t.lifes--,t.lifes>0&&t.renderImages(),0===t.lifes&&window.scene.scene.start("End")},this.renderImages=function(){t.images.forEach((function(e){return e.destroy()})),Object(j.a)(Array(t.lifes)).forEach((function(e,n){t.images.push(window.scene.add.image(t.getTextXPosition()-30*n,s-a/2,E.VIMBOY).setTint(De[n]).setFrame(H))}))},this.getTextXPosition=function(){return r-20}}return Object(y.a)(e,[{key:"create",value:function(){this.renderImages()}}]),e}(),Ge=u/a,Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.getWords(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te.getNumber(Ge),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3*-a,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;if(!window.scene.entityManager.lineHasEnemy(t)){var o=t*a,s=Ne({x:i,y:o,word:e.join(""),xVelocity:n,colour:te.getStringColour()}),c={line:t,type:z.WORD_TYPE_ENEMY,onCollision:function(e,t){return Ve(s,e,t)},words:e,normalVelocity:n};return s.setData({data:c}),s}},Ve=function(e,t,n){switch(t.type){case z.WORD_ATTACK:var i=n,o=e.text.toLowerCase().trim(),r=o.charAt(0);i.text.toLowerCase()===r&&(window.scene.sound.play(ee.BOOP),1===e.text.length?window.scene.entityManager.destroyEnemy(e):(e.setText(o.substr(1)),window.scene.scoreBoard.updateScore(1))),ne(i.x,i.y+a/2),window.scene.entityManager.destroyNonEnemy(i)}},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4*-a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te.getNumber(l);if(!window.scene.entityManager.getNonEnemyOnLine(t)){var n=t*a-a/2,i=te.getColour(),o=window.scene.add.sprite(r+200,n,E.VIMBOY).setTint(i).setFrame(13),s=J(o);Q(s,e);var c={line:t,type:z.PICKUP,colour:i,normalVelocity:e};return o.setData({data:c}),o}},_e=function(){function e(){var t=this;Object(h.a)(this,e),this.enemies=void 0,this.nonEnemies=void 0,this.generationPaused=!1,this.create=function(){t.enemies=window.scene.add.group(),t.nonEnemies=window.scene.add.group(),window.scene.physics.add.overlap(t.nonEnemies,t.enemies,t.onCollision),window.scene.physics.add.overlap(window.scene.vimboy.vimboy,t.enemies,window.scene.vimboy.onEnemyCollision),window.scene.physics.add.overlap(window.scene.vimboy.vimboy,t.nonEnemies,window.scene.vimboy.onPickupCollision)},this.onCollision=function(e,t){var n=t.getData("data"),i=e.getData("data");n.line===i.line&&n.onCollision(i,e)},this.lineHasEnemy=function(e){return void 0!==t.getFirstWordOnLine(e)},this.lineHasNonEnemy=function(e){return void 0!==t.getNonEnemyOnLine(e)},this.getFirstWordOnLine=function(e){return t.getOnLine(e,t.enemies)},this.getNonEnemyOnLine=function(e){return t.getOnLine(e,t.nonEnemies)},this.getOnLine=function(e,t){var n=void 0;return t.children.each((function(t){t.getData("data").line===e&&(n=t)})),n},this.cleanup=function(e){var n=e.body;(n.x<0-r||n.x>r+200)&&t.destroyEnemy(e)},this.destroyEnemy=function(e){e.destroy(),t.enemies.remove(e)},this.destroyNonEnemy=function(e){e.destroy(),t.nonEnemies.remove(e)},this.moveEverythingRight=function(){t.applyToAll((function(e){e.setX(e.x+a)}))},this.moveEverythingLeft=function(){t.applyToAll((function(e){e.setX(e.x-a)}))},this.matchToTimescale=function(){t.applyToAll((function(e,t,n){t.setVelocityX(n.normalVelocity*window.scene.tweens.getGlobalTimeScale())}))},this.applyToAll=function(e){t.enemies&&t.enemies.getChildren().forEach((function(t){var n=t,i=t.body,o=t.getData("data");e(n,i,o)})),t.nonEnemies&&t.nonEnemies.getChildren().forEach((function(t){var n=t,i=t.body,o=t.getData("data");e(n,i,o)}))}}return Object(y.a)(e,[{key:"createEnemy",value:function(e){var t=e();t&&this.enemies.add(t)}},{key:"createNonEnemy",value:function(e){var t=e();t&&this.nonEnemies.add(t)}},{key:"update",value:function(){this.generationPaused||this.generate(),this.enemies.children.each(this.cleanup),this.nonEnemies.children.each(this.cleanup)}},{key:"pauseRandomGeneration",value:function(){this.generationPaused=!0}},{key:"unpauseRandomGeneration",value:function(){this.generationPaused=!1}},{key:"generate",value:function(){var e=te.getNumber(300);(1===e||this.enemies.getChildren().length<3)&&this.createEnemy(Ke),(2===e||this.nonEnemies.getChildren().length<1)&&this.createNonEnemy(Ye)}},{key:"getEnemiesAboveLine",value:function(e){return this.enemies.getChildren().filter((function(t){return t.getData("data").line<e}))}},{key:"destroyAll",value:function(){this.enemies.children.each(this.destroyEnemy),this.nonEnemies.children.each(this.destroyNonEnemy)}},{key:"getEnemies",value:function(){return this.enemies.getChildren()}}]),e}(),We=function(){function e(){var t=this;Object(h.a)(this,e),this.verbs=[],this.nouns=[],this.selectedVerb=void 0,this.selectedNoun=void 0,this.presetVerb=void 0,this.presetNoun=void 0,this.addPowerUp=function(e){if(te.randomBool()){var n=t.presetVerb||te.randomStringEnum(ue);t.drawPowerUp(e,t.verbs,n)}else{var i=t.presetNoun||te.randomStringEnum(de);t.drawPowerUp(e,t.nouns,i)}},this.drawPowerUp=function(e,n,i){6===n.length&&n.shift().destroy(!0);var o=window.scene.add.sprite(0,He,E.VIMBOY).setFrame(F),a=window.scene.add.text(0,Fe,i,Xe);o.setTint(e),o.setData("powerUp",i),o.setData("colour",e);var r=window.scene.add.group([o,a]);n.push(r),t.refreshGroupPositioning()},this.canUsePowerUp=function(e,n){return void 0!==t.selectedVerb&&t.getFromGroup(t.selectedVerb).sprite.getData("data")===e&&void 0!==t.selectedNoun&&t.getFromGroup(t.selectedNoun).sprite.getData("data")===n},this.clearUsedSelected=function(e){var n=t.getFromGroup(e).sprite;ne(n.x,n.y),n.setTint(o.PINK),window.scene.time.addEvent({delay:500,callback:function(){e.destroy(!0)}})},this.clearUnusedSelected=function(e){t.getFromGroup(e).sprite.setTint(o.RED),window.scene.time.addEvent({delay:500,callback:function(){e.destroy(!0)}})},this.hasVerb=function(){return void 0!==t.selectedVerb},this.findThingIndex=function(e,n){return n.findIndex((function(n){return t.getFromGroup(n).sprite.getData("powerUp")===e}))},this.refreshGroupPositioning=function(){t.verbs.forEach((function(e,n){return t.updateX(e,r/2-n*a-3*a)})),t.nouns.forEach((function(e,n){return t.updateX(e,r/2+n*a+3*a)}))},this.updateX=function(e,n){var i=t.getFromGroup(e),o=i.sprite,a=i.text;o.setX(n),a.setX(t.getTextXPosition(n))},this.getTextXPosition=function(e){return e-a/2+5},this.addLabel=function(e,n){return window.scene.add.text(t.getTextXPosition(e),Fe,n,Xe)},this.getFromGroup=function(e){return{sprite:e.getChildren()[0],text:e.getChildren()[1]}},this.hasVerbs=function(){return t.verbs.length>0},this.hasNouns=function(){return t.nouns.length>0}}return Object(y.a)(e,[{key:"setVerbIfAvailable",value:function(e){this.selectedVerb=this.useItemAndCreateSelected(e,this.verbs,r/2-a+2)}},{key:"setNounIfAvailable",value:function(e){this.selectedNoun=this.useItemAndCreateSelected(e,this.nouns,r/2+a-2)}},{key:"useItemAndCreateSelected",value:function(e,t,n){var i=this.findThingIndex(e,t);if(-1!==i){var o=t[i],a=this.getFromGroup(o).sprite.getData("colour");o.destroy(!0),t.splice(i,1),this.refreshGroupPositioning();var r=window.scene.add.sprite(n,He,E.VIMBOY);r.setTint(a),r.setData("data",e),r.setFrame(F);var s=this.addLabel(n,e);return window.scene.add.group([r,s])}}},{key:"clear",value:function(){this.selectedVerb&&(window.scene.sound.play(ee.BAD),this.clearUsedSelected(this.selectedVerb)),this.selectedNoun&&this.clearUsedSelected(this.selectedNoun),this.selectedVerb=void 0,this.selectedNoun=void 0}},{key:"unusedClear",value:function(){this.selectedNoun&&this.clearUnusedSelected(this.selectedNoun),this.selectedVerb&&this.clearUnusedSelected(this.selectedVerb),this.selectedVerb=void 0,this.selectedNoun=void 0}},{key:"use",value:function(e){var t=this;!function(e,t,n){var o=window.scene.add.text(e,t,n,{fontFamily:T,fontSize:a,align:"center",color:i.WHITE});window.scene.time.addEvent({delay:500,callback:function(){o.destroy()}})}(a,s-a,e),window.scene.time.addEvent({delay:500,callback:function(){t.clear()}})}},{key:"create",value:function(){this.presetVerb=void 0,this.presetNoun=void 0,window.scene.add.sprite(r/2,s-1.5*a,E.POWER_UP_CONTAINER)}},{key:"update",value:function(){}}]),e}(),He=s-1.5*a,Fe=s-2*a+5,Xe={fontFamily:T,fontSize:30,align:"center",fixedWidth:a-10,color:i.WHITE},ze=We,qe=function(){function e(){Object(h.a)(this,e),this.music=void 0}return Object(y.a)(e,[{key:"create",value:function(){window.scene.sound.stopAll(),this.music=window.scene.sound.add(ee.MUSIC,{loop:!0,volume:.5}),this.music.play()}}]),e}(),Je=function(){window.scene.entityManager.createNonEnemy((function(){return Ye(8*-a,te.getRandomInt(5,l))}))},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te.getRandomInt(5,l);Ze(["boom"],e)},Ze=function(e,t,n){window.scene.entityManager.createEnemy((function(){return Ke(e,t,10*-a,n)}))},$e=function(e,t,n){"enter"===e.key.toLowerCase()?n(""):n(t+e.key.toLowerCase())},et=function(e){e.forEach((function(e,t){window.scene.time.addEvent({delay:1e3*t,callback:function(){Ze([e],t)}})}))},tt=[{text:["Hey there!","Try hitting 'k' to move up a line!"],keysToEnable:["k"],shouldRunNextStep:function(e){return"k"===e.key.toLowerCase()},type:"KeyBind"},{text:["Nice! Now try j to move down"],keysToEnable:["j"],shouldRunNextStep:function(e){return"j"===e.key.toLowerCase()},type:"KeyBind"},{text:["Cool! Try and pick up some presents","You can also use 'h' and 'l' to move left and right"],keysToEnable:["h","l"],type:"Update",onUpdate:function(){return Je()},shouldRunNextStep:function(){return window.scene.powerUpManager.hasNouns()&&window.scene.powerUpManager.hasVerbs()}},{text:["Next up is commands!","Typing a colon will enter you into command mode."],keysToEnable:["Shift:","Shift",":"],type:"KeyBind",shouldRunNextStep:function(e,t){return":"===e.key},onNonKeyMatch:$e},{text:["Following it with a number will let you jump to that line!","Give it a go! e.g. ':6' and hit enter"],keysToEnable:["Enter"].concat(Object(j.a)(Array.from(Array(10).keys()).map((function(e){return e.toString()})))),type:"KeyBind",shouldRunNextStep:function(e,t){return"enter"===e.key.toLowerCase()&&null!==t.match(/:[0-9]+/)},onNonKeyMatch:$e},{text:["Theres lots of commands so feel free to try different things!","Now lets make use of those presents","They can be either a verb or noun","Combine them to attack enemies by typing the letters on them","Try using the ones you picked up!"],type:"Update",onUpdate:function(){Je(),Qe()},shouldRunNextStep:function(){return window.scene.scoreBoard.score>0},keysToEnable:["d"]},{text:["Next up is modes","You can switch to insert mode by hitting 'i'"],keysToEnable:["i"],type:"KeyBind",shouldRunNextStep:function(e){return"i"===e.key.toLowerCase()},extra:function(){return window.scene.scoreBoard.resetScore()}},{text:["Now you're in insert mode","In this mode you can insert characters to attack","try typing things and destroy some letters"],onUpdate:function(){Qe(window.scene.vimboy.currentLine()-1)},keysToEnable:I,type:"Update",shouldRunNextStep:function(){return window.scene.scoreBoard.score>0}},{text:["Nice! Try switching back to normal mode","by hitting 'escape'"],keysToEnable:["escape"],shouldRunNextStep:function(e){return"escape"===e.key.toLowerCase()},type:"KeyBind"}],nt=function(){function e(t){var n=this;Object(h.a)(this,e),this.endTutorial=t,this.index=0,this.input="",this.funToRun=function(){},this.runNext=function(e){n.unbind(e),n.funToRun=function(){};var t=tt[n.index],i=t.text,o=t.keysToEnable,a=t.extra;et(i),o.forEach((function(e){window.scene.modeManager.allow(e)})),"KeyBind"===t.type&&n.handleKeybind(t),"Update"===t.type&&(n.funToRun=function(){t.onUpdate(),t.shouldRunNextStep()&&n.nextOrEnd()}),a&&a()},this.updateInput=function(e){n.input=e},this.handleKeybind=function(e){var t=e.shouldRunNextStep,i=e.onNonKeyMatch;window.scene.keyCapturer.addListener("keydown",(function e(o){t&&t(o,n.input)?n.nextOrEnd(e):i&&i(o,n.input,n.updateInput)}))},this.nextOrEnd=function(e){window.scene.entityManager.destroyAll(),n.index!==tt.length-1?(n.index++,n.runNext(e)):(n.funToRun=function(){},n.unbind(e),n.endTutorial())},this.unbind=function(e){e&&window.scene.keyCapturer.removeListener("keydown",e)}}return Object(y.a)(e,[{key:"start",value:function(){window.scene.entityManager.pauseRandomGeneration(),this.runNext()}},{key:"update",value:function(){this.funToRun()}}]),e}(),it=function(){function e(){Object(h.a)(this,e),this.tutorial=void 0,this.onComplete=function(){et(["Congrats thats the tutorial done","Type :q to go back to main menu","Or you can hang around here :)"]),window.tutorialMode=!1}}return Object(y.a)(e,[{key:"create",value:function(){window.tutorialMode&&(this.tutorial=new nt(this.onComplete),window.scene.modeManager.allowNone(),window.scene.vimboy.setBulletProof(!0),window.scene.powerUpManager.presetVerb=ue.d,window.scene.powerUpManager.presetNoun=de.d,this.tutorial.start())}},{key:"update",value:function(){window.tutorialMode&&this.tutorial.update()}}]),e}(),ot={active:!1,visible:!1,key:"Game"},at=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(w.a)(this,Object(f.a)(t).call(this,ot))).vimboy=void 0,e.modeManager=void 0,e.statusLine=void 0,e.scoreBoard=void 0,e.health=void 0,e.entityManager=void 0,e.powerUpManager=void 0,e.musicManager=void 0,e.keyCapturer=void 0,e.graphics=void 0,e.tutorialManager=void 0,window.scene=Object(m.a)(e),e.init(),e}return Object(p.a)(t,e),Object(y.a)(t,[{key:"preload",value:function(){X(),ae()}},{key:"create",value:function(){this.init(),window.scene.anims.create(q(W.VIMBOY_BOB,0,5,-1)),window.scene.anims.create(q(W.VIMBOY_WORD_ATTACK,5,1)),window.scene.anims.create(q(W.VIMBOY_UP,1,3)),window.scene.anims.create(q(W.VIMBOY_DOWN,6,3)),window.scene.anims.create(q(W.VIMBOY_POP,9,1)),window.scene.anims.create(q(W.CLASH,10,3)),this.keyCapturer=window.scene.input.keyboard.addCapture([g.a.Input.Keyboard.KeyCodes.I]),this.graphics=this.add.graphics({x:0,y:0}),new Y(this.graphics).drawBackground(),this.vimboy.create(),this.modeManager.create(),this.statusLine.create(),this.health.create(),this.scoreBoard.create(),this.entityManager.create(),this.powerUpManager.create(),this.musicManager.create(),this.tutorialManager.create()}},{key:"update",value:function(){this.vimboy.update(),this.modeManager.update(),this.statusLine.update(),this.entityManager.update(),this.powerUpManager.update(),this.tutorialManager.update()}},{key:"init",value:function(){this.vimboy=new re,this.modeManager=new Ie,this.scoreBoard=new Ae,this.health=new Ue,this.statusLine=new Se,this.entityManager=new _e,this.powerUpManager=new ze,this.musicManager=new qe,this.tutorialManager=new it}}]),t}(g.a.Scene);function rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rt(n,!0).forEach((function(t){Object(le.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct,ut={active:!1,visible:!1,key:"End"},dt=function(e){function t(){var e;return Object(h.a)(this,t),(e=Object(w.a)(this,Object(f.a)(t).call(this,ut))).replayButton=void 0,e.menuButton=void 0,e.replaySelected=!0,e.renderImage=function(t,n){var i=e.add.image(r/2,s/2,t);n&&(e.tweens.add({targets:i,repeat:-1,y:{from:s/2,to:s/2-10},yoyo:!0}),e.tweens.add({targets:i,duration:2e3,alpha:{from:.2,to:1},repeat:-1,yoyo:!0}))},e.renderText=function(t){var n=s/6;e.add.text(0,n,t,{fontFamily:T,fontSize:1.5*k,align:"center",fixedWidth:r,color:i.PINK}),e.add.text(0,n+2*a,"score: ".concat(window.scene.scoreBoard.score),st({},L,{align:"center",fixedWidth:r}))},e}return Object(p.a)(t,e),Object(y.a)(t,[{key:"preload",value:function(){}},{key:"create",value:function(){var e=this;this.sound.stopAll(),window.scene.scoreBoard.score>=100?(this.sound.play(ee.GOOD_SCORE),this.renderImage(E.TROPHY,!1),this.renderText("Wow!")):(this.sound.play(ee.DEATH),this.renderImage(E.GHOST,!0),this.renderText("Better luck next time!")),this.replayButton=this.add.text(0,3*s/4,"> Replay",st({},L,{align:"center",fixedWidth:r/2,color:i.YELLOW})),this.menuButton=this.add.text(r/2,3*s/4,"  Menu",st({},L,{align:"center",fixedWidth:r/2})),this.input.keyboard.on("keydown",(function(t){switch(t.key.toLowerCase()){case"arrowleft":case"h":e.replaySelected=!0,e.replayButton.setText("> Replay"),e.replayButton.setColor(i.YELLOW),e.menuButton.setText("  Menu"),e.menuButton.setColor(i.WHITE);break;case"arrowright":case"l":e.replaySelected=!1,e.menuButton.setText("> Menu"),e.menuButton.setColor(i.YELLOW),e.replayButton.setColor(i.WHITE),e.replayButton.setText("  Replay");break;case"enter":e.replaySelected?e.scene.start("Game"):e.scene.start("Menu")}}))}},{key:"update",value:function(){}}]),t}(g.a.Scene),lt={type:Phaser.AUTO,width:r,height:s,physics:{default:"arcade",arcade:{gravity:{y:200}}},scene:V};(ct=new Phaser.Game(lt)).scene.add("Game",at),ct.scene.add("End",dt)},541:function(e,t,n){e.exports=n(1442)},542:function(e,t,n){}},[[541,1,2]]]);
//# sourceMappingURL=main.333001a2.chunk.js.map